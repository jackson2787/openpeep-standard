{
  "$id": "https://openpeep-standard.org/schemas/ees/2025-08/ees.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Emergency Evacuation Statements (EES)",
  "type": "object",
  "additionalProperties": false,
  "$defs": {
    "person_statement": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "targetPersonId": { "type": "string", "format": "uuid" },
        "plainLanguageInstructions": { "type": "string", "description": "Clear, accessible instructions for the named person" },
        "assistanceRequired": {
          "type": "array",
          "items": { "type": "string" },
          "description": "e.g., buddy assistance, evac chair, guidance"
        },
        "equipment": { "type": "array", "items": { "type": "string" } },
        "contactOnAlarm": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "who": { "type": "string" },
            "how": { "type": "string", "description": "e.g., phone, SMS, app notification" }
          }
        },
        "translations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "language": { "type": "string" },
              "text": { "type": "string" }
            },
            "required": ["language", "text"],
            "additionalProperties": false
          }
        }
      },
      "required": ["plainLanguageInstructions"]
    }
  },
  "properties": {
    "schema_version": { "type": "string", "pattern": "^\\d+\\.\\d+\\.\\d+$" },
    "eesId": { "type": "string", "format": "uuid" },
    "address": { "$ref": "https://openpeep-standard.org/schemas/common/address.schema.json" },
    "building_statement": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "strategy": {
          "type": "string",
          "enum": ["Stay Put", "Simultaneous Evacuation", "Phased Evacuation", "Partial Evacuation"]
        },
        "instructions": { "type": "string", "description": "Plain-language building-wide instructions" },
        "alarmsInfo": { "type": "string", "description": "Alarm types, tones, visual alerts" },
        "evacuationLift": {
          "type": "object",
          "properties": {
            "available": { "type": "boolean" },
            "notes": { "type": "string" }
          },
          "additionalProperties": false
        },
        "refugeLocations": { "type": "array", "items": { "type": "string" } },
        "musterPoint": { "type": "string" },
        "stayPutConditions": { "type": "string", "description": "When 'Stay Put' ceases to apply" },
        "variationsByLevel": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": { "level": { "type": "string" }, "instructions": { "type": "string" } },
            "required": ["level", "instructions"],
            "additionalProperties": false
          }
        }
      },
      "required": ["strategy", "instructions"]
    },
    "person_statement": { "$ref": "#/$defs/person_statement" },
    "review": { "$ref": "https://openpeep-standard.org/schemas/common/review.schema.json" },
    "metadata": {
      "type": "object",
      "properties": {
        "effective_from": { "type": "string", "format": "date" },
        "effective_to": { "type": "string", "format": "date" },
        "created_by": { "type": "string" }
      },
      "additionalProperties": false
    }
  },
  "required": ["eesId", "address", "building_statement", "review"]
}